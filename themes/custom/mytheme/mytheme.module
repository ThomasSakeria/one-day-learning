<?php

/**
 * @file
 * Contains mytheme.module.
 */

use Drupal\Core\Routing\RouteMatchInterface;

/**
 * Implements hook_theme().
 */
function mytheme_theme() {
  return [
    'page__about_us' => [
      'base hook' => 'page',
      'template' => 'layout/page--about-us',
      'variables' => [],
    ],
    'page__front' => [
      'base hook' => 'page',
      'template' => 'layout/page--front',
      'variables' => [],
    ],
  ];
}

/**
 * Implements hook_theme_suggestions_HOOK_alter() for page().
 */
function mytheme_theme_suggestions_page_alter(array &$suggestions, array $variables) {
  $route_name = \Drupal::routeMatch()->getRouteName();
  $path = \Drupal::service('path.current')->getPath();
  
  // Add front page suggestion (including Views front page)
  if ($route_name === 'system.site_front_page' || 
      $route_name === 'view.frontpage.page_1' ||
      $path === '/' || 
      $path === '/drupal' || 
      $path === '/drupal/' ||
      $path === '/node') {
    $suggestions[] = 'page__front';
  }
  
  if ($route_name === 'entity.node.canonical') {
    $node = \Drupal::routeMatch()->getParameter('node');
    if ($node && $node->getType() === 'page') {
      $suggestions[] = 'page__' . $node->getType() . '__' . $node->id();
    }
  }
}

/**
 * Implements hook_page_attachments().
 */
function mytheme_page_attachments(array &$attachments) {
  $route_name = \Drupal::routeMatch()->getRouteName();
  
  if ($route_name === 'entity.node.canonical') {
    $node = \Drupal::routeMatch()->getParameter('node');
    if ($node && $node->getType() === 'page') {
      $attachments['#attached']['library'][] = 'mytheme/global-styling';
    }
  }
} 