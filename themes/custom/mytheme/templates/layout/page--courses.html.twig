{% extends "@mytheme/layout/page.html.twig" %}

{#
/**
 * @file
 * Theme implementation for the courses page.
 */
#}

{% block content %}
  <div class="courses-page-section">
    <div class="courses-page-content">
      <div class="courses-header">
        <h1>All Courses</h1>
        <p>Discover our comprehensive range of courses designed to enhance your skills and advance your career.</p>
      </div>

      {% if courses %}
        <div class="courses-filters">
          <div class="filter-group">
            <label for="topicFilter">Filter by Topic:</label>
            <select id="topicFilter" class="filter-select">
              <option value="">All Topics</option>
              <option value="web-development">Web Development</option>
              <option value="data-science">Data Science</option>
              <option value="digital-marketing">Digital Marketing</option>
              <option value="ui-ux-design">UI/UX Design</option>
              <option value="mobile-app-development">Mobile App Development</option>
              <option value="cloud-computing">Cloud Computing</option>
              <option value="cybersecurity">Cybersecurity</option>
              <option value="artificial-intelligence">Artificial Intelligence</option>
              <option value="blockchain-development">Blockchain Development</option>
              <option value="data-analytics">Data Analytics</option>
              <option value="software-testing">Software Testing</option>
              <option value="project-management">Project Management</option>
            </select>
          </div>
          <div class="filter-group">
            <label for="dateFilter">Filter by Date:</label>
            <select id="dateFilter" class="filter-select">
              <option value="">All Dates</option>
              <option value="june">June 2025</option>
              <option value="july">July 2025</option>
              <option value="august">August 2025</option>
            </select>
          </div>
          <button id="clearFilters" class="clear-filters-btn">Clear Filters</button>
        </div>

        <div class="course-count">
          <span id="courseCount">{{ courses|length }}</span> courses found
        </div>

        <div class="courses-grid" id="coursesGrid">
          {% for course_slug, course in courses %}
            <div class="course-card" data-topic="{{ course_slug }}" data-date="{{ course.course_date|lower|replace({' ': '-'}) }}">
              <div class="course-image">
                <img src="{{ base_path ~ directory }}/images/{{ course.image }}" alt="{{ course.title }}" loading="lazy">
                {% if course.available_slots == 0 %}
                  <div class="course-badge fully-booked">Fully Booked</div>
                {% endif %}
              </div>
              <div class="course-info">
                <h3>{{ course.title }}</h3>
                <p>{{ course.description }}</p>
                <div class="course-meta">
                  <span class="course-date"><i class="fas fa-calendar"></i> {{ course.course_date }}</span>
                  <span class="course-slots available"><i class="fas fa-users"></i> {{ course.available_slots }} slots available</span>
                </div>
                <button class="course-link" onclick="showCourseDetails('{{ course_slug }}', '{{ course.title }}')">Learn More</button>
              </div>
            </div>
          {% endfor %}
        </div>

        <div id="noResults" class="no-results" style="display: none;">
          <div class="no-results-content">
            <i class="fas fa-search"></i>
            <h3>No courses found</h3>
            <p>Try adjusting your filters to find more courses.</p>
            <button onclick="clearAllFilters()" class="clear-filters-btn">Clear All Filters</button>
          </div>
        </div>
      {% else %}
        <div class="no-courses">
          <i class="fas fa-graduation-cap"></i>
          <h3>No courses available at the moment</h3>
          <p>We're currently updating our course catalog. Please check back soon.</p>
        </div>
      {% endif %}
    </div>
  </div>
{% endblock %}

{% block scripts %}
  {{ parent() }}
  <script>
    function filterCourses() {
      const topicFilter = document.getElementById('topicFilter').value;
      const dateFilter = document.getElementById('dateFilter').value;
      const courseCards = document.querySelectorAll('.course-card');
      let visibleCount = 0;
      courseCards.forEach(card => {
        const topic = card.dataset.topic;
        const date = card.dataset.date;
        let showCard = true;
        if (topicFilter && topic !== topicFilter) {
          showCard = false;
        }
        if (dateFilter && !date.includes(dateFilter)) {
          showCard = false;
        }
        if (showCard) {
          card.style.display = 'block';
          visibleCount++;
        } else {
          card.style.display = 'none';
        }
      });
      document.getElementById('courseCount').textContent = visibleCount;
      const noResults = document.getElementById('noResults');
      const coursesGrid = document.getElementById('coursesGrid');
      if (visibleCount === 0) {
        noResults.style.display = 'block';
        coursesGrid.style.display = 'none';
      } else {
        noResults.style.display = 'none';
        coursesGrid.style.display = 'grid';
      }
    }
    function clearAllFilters() {
      document.getElementById('topicFilter').value = '';
      document.getElementById('dateFilter').value = '';
      filterCourses();
    }
    document.addEventListener('DOMContentLoaded', function() {
      document.getElementById('topicFilter').addEventListener('change', filterCourses);
      document.getElementById('dateFilter').addEventListener('change', filterCourses);
      document.getElementById('clearFilters').addEventListener('click', clearAllFilters);
    });
  </script>
{% endblock %}